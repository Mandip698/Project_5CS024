{% extends "main.html" %}
{% block content %}
    {% load static %}
    <p>Raw GET status: {{ request.GET.status }}</p>

    <div class="container my-5">
        <div class="table-responsive">
            <table id="table"
                   class="table table-borderless table-striped table-hover"
                   data-pagination="true"
                   data-show-toggle="true"
                   data-card-view="true"
                   data-search="true"
                   data-show-jump-to="true"
                   data-side-pagination="client">
<form method="get" action="{% url 'dashboard' %}" class="mb-3">
    <label for="status">Filter by status:</label>
    <select name="status" id="status" class="form-select w-auto d-inline mx-2">
        <option value="">All</option>
        <option value="live" {% if status_filter == 'live' %}selected{% endif %}>Live</option>
        <option value="closed" {% if status_filter == 'closed' %}selected{% endif %}>Closed</option>
        <option value="pending" {% if status_filter == 'pending' %}selected{% endif %}>Pending</option>
    </select>
    <button type="submit" class="btn btn-primary">Filter</button>
</form>

<p class="text-muted">Selected status: {{ status_filter|default:"All" }}</p>





                <thead>
                    <tr class="table-header text-center">
                        <th data-field="polls" data-sortable="true">Polls</th>
                        <th data-field="endtime" data-sortable="true">Deadline</th>
                        <th data-field="status" data-sortable="true">Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for poll in polls %}
                        <tr class="table-row text-center"
                            data-url="{% url 'vote_poll' poll.id %}">
                            <td>
                                <strong>{{ poll.topic }}</strong>
                                <br />
                                <small>{{ poll.description }}</small>
                            </td>
                            <td>{{ poll.end_date|date:"F d, Y g:i A" }}</td>
                            <td>
                                {% if poll.status == "live" %}
                                    <span class="badge bg-success">Live</span>
                                {% elif poll.status == "closed" %}
                                    <span class="badge bg-danger">Closed</span>
                                {% elif poll.status == "pending" %}
                                    <span class="badge bg-warning text-dark">Pending</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% empty %}
                        <tr class="text-center">
                            <td colspan="3">No polls available.</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock content %}
